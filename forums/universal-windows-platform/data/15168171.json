{"id":"15168171","link":"https://wpdev.uservoice.com/forums/110705-universal-windows-platform/suggestions/15168171-failing-to-start-isolated-environment","title":"Failing to start isolated environment","body":"[msft] \n<br>Right now creating an isolated environment fails for some installers. if you see “E_STARTING_ISOLATED_ENV_FAILED” or “800705B4”, chances are it is this.  If you feel it isn’t, please create a new issue.","votes":"52","user":"https://wpdev.uservoice.com/users/166449207-james","datetime":"2016-07-12","comments":[{"user":"https://wpdev.uservoice.com/users/161576778","datetime":"2017-07-19","body":"After install KB4025342, occur same error as E_STARTING_ISOLATED_ENV_FAILED (time out operation by Isolation Environment started). \n<br>I uninstall KB4025342, DAC's convert is success."},{"user":"https://wpdev.uservoice.com/users/234065203-dac","datetime":"2016-12-28","body":"Is it that a different installer should be used instead of the built-in installer project?"},{"user":"https://wpdev.uservoice.com/users/286776266-rana-khan","datetime":"2016-11-28","body":"Kindly Provide a resolution to this Issue!! Everything workout pretty smooth, until it gets to the step where it creates an isolated enviroment and it fails every time. Gives the following Error \" Failed to create the isolated environment\""},{"user":"https://wpdev.uservoice.com/users/286776266-rana-khan","datetime":"2016-11-28","body":"No installer valid exit codes specified. Using defaults: 0\n<br>[2016-11-28T13:55:45] Replace any occurence of &lt;log_folder&gt; in -InstallerArguments with C:\\shared\\logs\n<br>[2016-11-28T13:55:45] Creating Isolated Environment\n<br>[2016-11-28T13:55:47] An error occurred running your installer in isolation\n<br>[2016-11-28T13:55:47] Invoke-IsolatedInstall : error 'E_CREATING_ISOLATED_ENV_FAILED': Failed to create the isolated environment. See inner exception for more details.\n<br>[2016-11-28T13:55:47] Moving any logs in C:\\DesktopAppConverter\\3212ae44-8211-4d5d-88f3-33729578d4a8\\shared\\logs to C:\\DesktopAppConverter\\3212ae44-8211-4d5d-88f3-33729578d4a8\\logs\n<br>[2016-11-28T13:55:47] Moving any dac output in C:\\DesktopAppConverter\\3212ae44-8211-4d5d-88f3-33729578d4a8\\shared\\dac\\out to C:\\DesktopAppConverter\\3212ae44-8211-4d5d-88f3-33729578d4a8\\output\\dac\n<br>[2016-11-28T13:55:47] Cleaning up by removing isolated environment shared folder C:\\DesktopAppConverter\\3212ae44-8211-4d5d-88f3-33729578d4a8\\shared\n<br>[2016-11-28T13:55:47] An error occurred converting your application. Here is the full error record: \n<br>[2016-11-28T13:55:47] "},{"user":"https://wpdev.uservoice.com/users/276907117","datetime":"2016-11-09","body":"....\n<br>   в Microsoft.Windows.ComputeVirtualization.Container.&lt;StartAsync&gt;d__8.MoveNext()\n<br>Inner Exception Stack Trace[3]\n<br>   в Microsoft.Windows.ComputeVirtualization.HcsFactory.Hcs.ProcessHcsCall(Int32 resultCode, String result)\n<br>   в\n<br>Microsoft.Windows.ComputeVirtualization.HcsFactory.Hcs.Microsoft.Windows.ComputeVirtualization.IHcs.StartComputeSystem(\n<br>IntPtr computeSystem, String options)\n<br>   в Microsoft.Windows.ComputeVirtualization.Container.&lt;StartAsync&gt;d__8.MoveNext()"},{"user":"https://wpdev.uservoice.com/users/276907117","datetime":"2016-11-09","body":"I still have this error. Nothing can fix it((. I've spent weeks on it still geting the \"time out\" error"},{"user":"https://wpdev.uservoice.com/users/279101665-marcel","datetime":"2016-11-08","body":"Also having problems to convert. This is my log :"},{"user":"https://wpdev.uservoice.com/users/68344437-clint-rutkas-msft","datetime":"2016-10-28","body":"@Tommi <a rel=\"nofollow noreferrer\" href=\"https://developer.microsoft.com/en-us/windows/projects/campaigns/desktop-bridge\">https://developer.microsoft.com/en-us/windows/projects/campaigns/desktop-bridge</a> for going to store."},{"user":"https://wpdev.uservoice.com/users/254083267-tommi-utriainen","datetime":"2016-10-28","body":"Thanks, I solved the issue myself already, it seems there was no warning message(s) if Hyper-V is not installed to Win10,  please add some extra checks/warning messages to the scripts."},{"user":"https://wpdev.uservoice.com/users/261013336","datetime":"2016-10-26","body":"still waiting for a patch..."},{"user":"https://wpdev.uservoice.com/users/261013336","datetime":"2016-10-09","body":"Same problem with Windows 10 Pro Anniversary Update."},{"user":"https://wpdev.uservoice.com/users/234065203-dac","datetime":"2016-10-07","body":"I used this as a not-mine test.  Matter of fact, it's your.  FAILED as I already demonstrated a month or so ago."},{"user":"https://wpdev.uservoice.com/users/254502181-sangamesh-gouri","datetime":"2016-09-27","body":"I too have 14393 OS build and installed DAC converter Tool with image set up of BaseImage-14393.wim. But conversion process from MSI/Exe to UWP stops at below point in the DesktopAppCOnverter.log \"Waiting for installer process to complete inside Isolated Environment\" and deosn't proceed further."},{"user":"https://wpdev.uservoice.com/users/254083267-tommi-utriainen","datetime":"2016-09-27","body":"\nInner Exception[4]:\n<br>System.Runtime.InteropServices.COMException (0x800705B4): This operation returned because the timeout period expired.\n<br>(Exception from HRESULT: 0x800705B4)\n<br>VERBOSE: The full error record is saved in the logs at C:\\DesktopAppConverter\\4e2c2695-d2df-4384-b4e7-27b2a8f5e93d\\logs\n<br>C:\\Program Files\\WindowsApps\\Microsoft.DesktopAppConverter_1.0.0.0_x64__8wekyb3d8bbwe\\DesktopAppConverter.ps1 :\n<br>DesktopAppConverter : error 'E_STARTING_ISOLATED_ENV_FAILED': Failed to start the isolated environment. See inner\n<br>exception for more details.\n<br>At line:1 char:1\n<br>+ .\\DesktopAppConverter.ps1 -Installer C:\\tq\\T10.exe -Install ...\n<br>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n<br>    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException\n<br>    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,DesktopAppConverter.ps1"},{"user":"https://wpdev.uservoice.com/users/242877589-ionwerks","datetime":"2016-09-14","body":"Same issue.\n<br>Same log file as the last poster.\n<br>MSI+InstalerArguments installs (silently) without issue in a test machine.\n<br>BaseImage-14393.wim\n<br>Desktop App Converter 1.0.0.release_2016-09-12_17-35_ffbf3b5cdc49b01e13ab503dae648326acae0991"},{"user":"https://wpdev.uservoice.com/users/215901288-adrian-wenz","datetime":"2016-09-07","body":"I can confirm this issue too using Windows 10 Pro (14393.105) and the DesktopAppConverter v0.1.25.\n<br>The process seems to time-out after having started the isolated environment.\n"},{"user":"https://wpdev.uservoice.com/users/234459718-shozo-arai","datetime":"2016-09-07","body":"Me too. I have two environments.\n<br>First is Windows 10 Professional Edition. This is same problem.\n<br>---------------under the log---------------------\n<br>Running Installer in Isolated Environment\n<br>[2016-09-06T11:30:37] No installer valid exit codes specified. Using defaults: 0\n<br>[2016-09-06T11:30:37] Replace any occurence of &lt;log_folder&gt; in -InstallerArguments with C:\\shared\\logs\n<br>[2016-09-06T11:30:37] Creating Isolated Environment\n<br>[2016-09-06T11:30:39] Starting the Isolated Environment\n<br>[2016-09-06T11:32:40] An error occurred running your installer in isolation\n<br>[2016-09-06T11:32:40] Invoke-IsolatedInstall : error 'E_STARTING_ISOLATED_ENV_FAILED': Failed to start the isolated environment. See inner exception for more details.\n<br>--------------log end--------------"},{"user":"https://wpdev.uservoice.com/users/234065203-dac","datetime":"2016-09-06","body":"Getting the same thing, the timeout after 120 seconds:"},{"user":"https://wpdev.uservoice.com/users/229650712-anonymous","datetime":"2016-08-29","body":"System.Runtime.InteropServices.COMException (0x80070490): Element not found. (Exception from HRESULT: 0x80070490)\n<br>VERBOSE: The full error record is saved in the logs at C:\\DesktopAppConverter\\6148da06-cc1c-4d79-8c66-60e9675eaff9\\logs\n<br>C:\\Users\\apchin\\Desktop\\DesktopAppCon\\DesktopAppConverter\\DesktopAppConverter.ps1 : DesktopAppConverter : error \n<br>'E_WAITING_FOR_ISOLATED_PROCESS_FAILED': Failed to wait for isolated process to exit. See inner exception for more details.\n<br>At line:1 char:1\n<br>+ .\\DesktopAppConverter.ps1 -Installer C:\\Temp\\vlc.exe -InstallerArgume ...\n<br>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n<br>    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException\n<br>    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,DesktopAppConverter.ps1"},{"user":"https://wpdev.uservoice.com/users/215901288-adrian-wenz","datetime":"2016-08-12","body":"In addition to my previous post I should also mention:"}]}