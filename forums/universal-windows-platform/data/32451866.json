{"id":"32451866","link":"https://wpdev.uservoice.com/forums/110705-universal-windows-platform/suggestions/32451866-baseimage-16299","title":"BaseImage 16299","body":"Installing BaseImage 16299 FailsThe DesktopAppConverter 2.1.1.release_2017-10-25 fails when Installing BaseImage \"Windows_InsiderPreview_DAC_16299.wim\" with PowerShell Error Record:\n<br>Ausnahme beim Aufrufen von \"ProcessBaseLayer\" mit 1 Argument(en):  \"Der Wert liegt außerhalb des erwarteten Bereichs.\"\n<br>PowerShell Stack Trace:\n<br>bei Expand-BaseImage, C:\\Program Files\\WindowsApps\\Microsoft.DesktopAppConverter_2.1.1.0_x64__8wekyb3d8bbwe\\converter_util\\BaseImageOps.ps1: Zeile 388\n<br>bei Setup-ExpandedImages, C:\\Program Files\\WindowsApps\\Microsoft.DesktopAppConverter_2.1.1.0_x64__8wekyb3d8bbwe\\Setup.ps1: Zeile 245\n<br>bei Setup-DesktopAppConverter, C:\\Program Files\\WindowsApps\\Microsoft.DesktopAppConverter_2.1.1.0_x64__8wekyb3d8bbwe\\Setup.ps1: Zeile 139\n<br>bei &lt;ScriptBlock&gt;&lt;Process&gt;, C:\\Program Files\\WindowsApps\\Microsoft.DesktopAppConverter_2.1.1.0_x64__8wekyb3d8bbwe\\DesktopAppConverter.ps1: Zeile 382\n<br>bei &lt;ScriptBlock&gt;, &lt;Keine Datei&gt;: Zeile 1\n<br>Inner Exception[0]:\n<br>System.Management.Automation.MethodInvocationException: Ausnahme beim Aufrufen von \"ProcessBaseLayer\" mit 1 Argument(en):  \"Der Wert liegt außerhalb des erwarteten Bereichs.\" ---&gt; System.ArgumentException: Der Wert liegt außerhalb des erwarteten Bereichs.\n<br>   bei Microsoft.Windows.ComputeVirtualization.ContainerStorage.StorageFunctions.ProcessBaseImage(String path)\n<br>   bei Microsoft.Windows.ComputeVirtualization.ContainerStorage.ProcessBaseLayer(String path)\n<br>   bei CallSite.Target(Closure , CallSite , Type , Object )\n<br>   --- Ende der internen Ausnahmestapelüberwachung ---\n<br>   bei System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)\n<br>   bei System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.Interpreter.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.LightLambda.RunVoid1[T0](T0 arg0)\n<br>   bei System.Management.Automation.PSScriptCmdlet.RunClause(Action`1 clause, Object dollarUnderbar, Object inputToProcess)\n<br>   bei System.Management.Automation.PSScriptCmdlet.DoEndProcessing()\n<br>   bei System.Management.Automation.CommandProcessorBase.Complete()\n<br>Inner Exception Stack Trace[0]\n<br>   bei System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)\n<br>   bei System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.Interpreter.Run(InterpretedFrame frame)\n<br>   bei System.Management.Automation.Interpreter.LightLambda.RunVoid1[T0](T0 arg0)\n<br>   bei System.Management.Automation.PSScriptCmdlet.RunClause(Action`1 clause, Object dollarUnderbar, Object inputToProcess)\n<br>   bei System.Management.Automation.PSScriptCmdlet.DoEndProcessing()\n<br>   bei System.Management.Automation.CommandProcessorBase.Complete()","votes":"6","user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2017-12-01","comments":[{"user":"https://wpdev.uservoice.com/users/776494876-dick","datetime":"2018-04-12","body":"I have about the same problem (W_BASEIMG_VERSION_NOT_VERIFIED) with 15063 (I blocked the Creators Fall Update for a year).  "},{"user":"https://wpdev.uservoice.com/users/150091857-chris-shields","datetime":"2018-03-30","body":"Any news? Same E_EXPANDED_BASEIMG_INVALID error"},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2018-02-16","body":"Are there any news for us?"},{"user":"https://wpdev.uservoice.com/users/745374271-whiteside","datetime":"2018-01-25","body":"Thanks for bearing with us, Markus - and thank you for running those steps.  That confirms that it's the ProcessBaseLayer call in the ComputeVirtualization module (a .NET component the DAC relies upon) that is failing."},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2018-01-25","body":"Clint, i do the steps several times before and the Problem still exists. Now i will do the steps you explained again. First of all on my PC the Folder c:\\ProrgamData\\Micrsoft\\Windows\\Images wasn't empty. I called \"DesktopAppConverte -cleanup ALL -verbose\" resulting in \"AUSFÜHRLICH: Cleanup Complete\", RestartNeeded: False. \n<br>The above folder wasn't empty after that, so i delete it manually (after taking ownership).\n<br>Now i download \"Windows_InsiderPreview_DAC_16299.wim\" from <a rel=\"nofollow noreferrer\" href=\"https://www.microsoft.com/en-us/software-download/dac#!\">https://www.microsoft.com/en-us/software-download/dac#!</a>.\n<br>Next step is to install this Image with \"DesktopAppConverter -Setup -BaseImage c:\\temp\\Windows_InsiderPreview_DAC_16299.wim -Verbose\"."},{"user":"https://wpdev.uservoice.com/users/68344437-clint-rutkas-msft","datetime":"2018-01-24","body":"Markus, can you\n<br>- Run cleanup again\n<br>- Ensure the base image expansion is gone. These should be empty,\n<br>-     dir C:\\ProgramData\\Microsoft\\Windows\\Images\\\n<br>-     dir C:\\ProgramData\\Microsoft\\Windows\\Images\\Windows_InsiderPreview_DAC_16299\n<br>- If above not empty, then delete manually (might need to be admin and take ownership of the files first)\n<br>- Then run setup again and send us the log if it fails (<a rel=\"nofollow noreferrer\" href=\"mailto:crutkas@microsoft.com\">crutkas@microsoft.com</a>)"},{"user":"https://wpdev.uservoice.com/users/68344437-clint-rutkas-msft","datetime":"2018-01-24","body":"@Markus, thanks for reminding me, pinging that thread again"},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2018-01-24","body":"@Clint Rutkas"},{"user":"https://wpdev.uservoice.com/users/724923181","datetime":"2017-12-17","body":"The possible cause is that the \"real\" baseimage files prior being replaced by fall preview contained the file cExecSvc.exe. Probably not a place for commentary, however some MS developer and the very least the QA team should get coal in their stockings. I have ten window 10 system and not a one has the  executable. Here is my purposed resolution:\n<br>The most simple is to post the file as a down load.\n<br>The more complete fix\n<br>1) Make the error message in converter_util\\InputValidation.ps1 to clearly indicate the executable \n<br>    is missing on the system and in the \"win file\"\n<br>2) Add the missing executable to existing preview image files.\n<br>3) Modify preview and production procedures  to include the executable.\n<br>    Foot note; All this can be accomplish before lunch under normal circumstances, "},{"user":"https://wpdev.uservoice.com/users/68344437-clint-rutkas-msft","datetime":"2017-12-15","body":"thanks, we're looking into this right now."},{"user":"https://wpdev.uservoice.com/users/724923181","datetime":"2017-12-15","body":"responce to Clint Rutkas on test. missing CExecSvc.exe"},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2017-12-13","body":"Yes, you are right. Executing your script Shows \"missing CExecSvc.exe\". And now, what can i do?"},{"user":"https://wpdev.uservoice.com/users/68344437-clint-rutkas-msft","datetime":"2017-12-13","body":"Can you run this:  we have a theory what may be causing this powershell command?  Replace your pathToBaseImage with where your wim file lives"},{"user":"https://wpdev.uservoice.com/users/724923181","datetime":"2017-12-12","body":"I have tried all of the workarounds suggested. Several month ago I was able to find a real baseimage-14393.win. The preview files don't seem to be valid replacements.\n<br>The website <a rel=\"nofollow noreferrer\" href=\"https://www.microsoft.com/en-us/software-download/dac\">https://www.microsoft.com/en-us/software-download/dac</a> appears broken.\n<br>if there a way to derive the simple base images from the previews?\n<br> I can't find any MS technical support goug that want to take ownership. \n<br>My windows build is 16299.98. Here is a part of a log using \n<br>Administrator powerShell\n<br>PS C:\\WINDOWS\\system32&gt; DesktopAppConverter.exe -Setup -BaseImage c:/Users/bwilley/Dow\n<br>nloads/Windows_InsiderPreview_DAC_16299.wim -verbose\n<br>VERBOSE: Desktop App Converter\n<br>2.1.1.release_2017-10-25_17-08_813cf2829a8823824411be7075c2d457efea7288\n<br>VERBOSE: --------------------------------------------------\n<br>Running Setup"},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2017-12-10","body":"I restartet when prompted, but same error. We are using Windows Defender as our antivirus solution, should i disable this?\n"},{"user":"https://wpdev.uservoice.com/users/170319330-windows-project-centennial-team","datetime":"2017-12-06","body":"The setup of the base image looks to have failed. Make sure you go through restart if you get prompted. After restart Powershell should start up and finish the operations."},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2017-12-05","body":"The Checksum of the file i've downloaded:\n<br> File: Windows_InsiderPreview_DAC_16299.wim\n<br>   MD5: a9e9de4df9a1214280632b374c94171d\n<br> SHA-1: 38f7b7235ac94efcf719160195da1b7f0ed9ee9c"},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2017-12-05","body":"Thank you for your message.\n<br>First step \"Cleanup\" seems to finish correct:"},{"user":"https://wpdev.uservoice.com/users/170319330-windows-project-centennial-team","datetime":"2017-12-04","body":"Thank you for the log."},{"user":"https://wpdev.uservoice.com/users/386725327-markus-koch","datetime":"2017-12-03","body":"I uploaded one: <a rel=\"nofollow noreferrer\" href=\"https://1drv.ms/u/s!AuZ-uPtjeSQL3End7a34hFVD5Z0t\">https://1drv.ms/u/s!AuZ-uPtjeSQL3End7a34hFVD5Z0t</a>\n"}]}